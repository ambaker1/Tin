\documentclass{article}

% Input packages & formatting
\input{template/packages}
\input{template/formatting}
\renewcommand{\cleartooddpage}[1][]{\ignorespaces} % single side
\newcommand{\caret}{$^\wedge$}

% Other macros
\renewcommand{\^}[1]{\textsuperscript{#1}}
\renewcommand{\_}[1]{\textsubscript{#1}}

\title{\Huge Tin: A Tcl Package Manager\\\small Version 0.3}
\author{Alex Baker\\\small\hyperlink{https://github.com/ambaker1/tin}{https://github.com/ambaker1/tin}}
\date{\small\today}
\begin{document}
\maketitle
\clearpage
\section{Accessing and Modifying the Tin Package Database}
Tin installs packages on the fly from corresponding GitHub repositories. 
The ``tinlist.tcl'' file in the Tin installation initializes the tin database, which can be modified within your local instance of Tcl with the commands \cmdlink{tin add} and \cmdlink{tin remove}.

\begin{syntax}
\command{tin add} \$name \$version \$repo \$tag \$installer
\end{syntax}
\begin{args}
\$name & Package name \\
\$version & Package version \\
\$repo & Github repository URL \\
\$tag & Github release tag for version \\
\$installer & Installer file path in repo 
\end{args}

\begin{syntax}
\command{tin remove} \$name \$version ...
\end{syntax}
\begin{args}
\$name & Package name \\
\$version ... & Package version(s) to remove
\end{args}

\begin{example}{Adding a package to the Tin}
\begin{lstlisting}
package require tin
tin add foo 1.0 https://github.com/username/foo v1.0 install_foo.tcl
\end{lstlisting}
\end{example}

The available packages can be queried with the command \cmdlink{tin packages}, and the versions for each package in ascending order can be queried with the command \cmdlink{tin versions}. If version requirements are specified in \cmdlink{tin versions}, it will filter using the rules of \textit{package vsatisfies}.

\begin{syntax}
\command{tin packages} <\$pattern>
\end{syntax}
\begin{args}
\$pattern & ``Glob'' pattern, default ``*'' 
\end{args}

\begin{syntax}
\command{tin versions} \$name <\$reqs ...>
tin versions \$name -exact \$version
\end{syntax}
\begin{args}
\$name & Package name \\
\$reqs ... & Package version requirements, mutually exclusive with -exact option. \\
\$version & Package version.
\end{args}

\section{Installing Tin-compatible packages}
The command \cmdlink{tin install} installs Tin-compatible packages directly from GitHub.
\begin{syntax}
\command{tin install} \$name <\$reqs ...>
tin install \$name -exact \$version
\end{syntax}
\begin{args}
\$name & Package name \\
\$reqs ... & Package version requirements, mutually exclusive with -exact option. \\
\$version & Package version.
\end{args}

\clearpage
\section{Requiring and importing packages}
The Tin package also provides advanced tools for requiring and importing packages.
The command \cmdlink{tin require} is similar to the Tcl command \textit{package require}, but with the added feature that if the package is missing, it will try to install it with \cmdlink{tin install}.
The command \cmdlink{tin import} additionally handles most use-cases of \textit{namespace import}. 
Both \cmdlink{tin require} and \cmdlink{tin import} return the version number of the package imported.
\begin{syntax}
\command{tin require} \$package <\$requirement ...>
\end{syntax}
\begin{args}
\$package & Package name \\
\$requirement ... & Version requirements. See Tcl \textit{package} documentation.
\end{args}
\begin{syntax}
\command{tin import} <\$patterns from> \$package <\$requirements> <as \$namespace>
\end{syntax}
\begin{args}
\$patterns & List of commands or "glob" style patterns to import. Default "*", or all exported commands. \\
\$package & Package name \\
\$requirements & List of version requirements. See Tcl \textit{package} documentation. \\
\$namespace & Namespace to import into (default global namespace)
\end{args}
\begin{example}{Importing all commands from a package}
\begin{lstlisting}
package require tin
tin import foo
\end{lstlisting}
\end{example}

\clearpage
\section{What makes a package Tin-compatible?}
Tin-compatible packages must have a "tinstall.tcl" file which copies required files from the main repository folder to the Tcl library folder, represented by variables \$src and \$dir, respectively. Additionally, the "tinstall.tcl" file must contain a \cmdlink{tin provide} statement at the end of the file with the package name and version. If a Tin package requires other Tin packages, dependencies can be handled with the \cmdlink{tin depend} command.
\begin{syntax}
\command{tin provide} \$package \$version
\end{syntax}
\begin{args}
\$package & Package name \\
\$version & Version number (e.g. 3.1.4)
\end{args}
\begin{syntax}
\command{tin depend} \$package <\$requirement ...>
\end{syntax}
\begin{args}
\$package & Package name \\
\$requirement ... & Version requirements. See Tcl \textit{package} documentation.
\end{args}

See the example below for the Tin package ``bar 2.4'' that requires the Tin package ``foo 1.2'':
\begin{example}{Example ``tinstall.tcl'' file}
\begin{lstlisting}
tin depend foo 1.2
file copy [file join $src README.md] $dir
file copy [file join $src LICENSE] $dir
file copy [file join $src lib/bar.tcl] $dir
file copy [file join $src lib/pkgIndex.pdf] $dir
tin provide bar 2.4
\end{lstlisting}
\end{example}

Including a "tinstall.tcl" file will make the repository compatible with the \cmdlink{tin extract} command. To make it compatible with the \cmdlink{tin install} command, which allows for automatic installation from GitHub, the repository must also have release tags with the format ``v0.0.0''.
\clearpage
\end{document}

